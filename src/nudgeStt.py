from elasticsearch import Elasticsearch
import datetime
import pymysql
import pandas as pd
import sys

config = {
    "SCHDB_IP": "1.255.144.64", "SCHDB_PORT": 3306, "SCHDB_USER": "nudge_1", "SCHDB_PASSWD": "0000", "SCHDB_DB": "nudge"
}

header = ["일자", "넛지종류", "노출문구", "노출위치",
          "넛지노출수", "넛지포커스수", "넛지 클릭수", "클릭전환율", "노출 STB수", "포커스 STB수", "클릭 STB수", "이용율"]
dataField = ["search_dt", "config", "man_text", "exposure_name", "show_count", "focus_count",
             "click_count", "show_click_rate", "show_stb_count", "focus_stb_count", "click_stb_count",
             "show_click_stb_rate"]


def makeParam(target_day):
    param = {"query": "", "time_zone": "Asia/Seoul", "fetch_size": 5000}
    param["query"] = f"""
    SELECT
      CONCAT(
            CONCAT(
               CONCAT(SUBSTRING(DATE_PART('year',format_dt)::string, 3,4) ,'.')
               , CASE
                  WHEN DATE_PART('month',format_dt) < 10 THEN CONCAT('0',DATE_PART('month',format_dt)::string)
                     ELSE DATE_PART('month',format_dt)::string
                   END
             ),
             CONCAT(
                    '.', CASE
                        WHEN DATE_PART('day',format_dt) < 10 THEN CONCAT('0',DATE_PART('day',format_dt)::string)
                        ELSE DATE_PART('day',format_dt)::string
                    END
                )
         ) search_dt
      ,man_text
      ,config
      ,target
         ,IFNULL( cast(   click_count       as integer )   ,0)   click_count
         , IFNULL( cast(   click_stb_count    as integer )   ,0)   click_stb_count
         , IFNULL( cast(   focus_count       as integer )   ,0)   focus_count
         , IFNULL( cast(   focus_stb_count    as integer )   ,0)   focus_stb_count
         , IFNULL( cast(   show_count       as integer )   ,0)   show_count
         , IFNULL( cast(   show_stb_count    as integer )    ,0)   show_stb_count
         , CASE
             WHEN IFNULL( cast(  show_count       as float )      ,0)  = 0 then 0
             ELSE
               ROUND(
                  IFNULL( cast(  click_count        as float )      ,0) /
                  IFNULL( cast(  show_count       as float )      ,0) * 100
                 , 2
               )
            END show_click_rate
          , CASE
             WHEN IFNULL( cast(  show_stb_count       as float )      ,0)  = 0 then 0
             ELSE
               ROUND(
                  IFNULL( cast(  click_stb_count        as float )      ,0) /
                  IFNULL( cast(  show_stb_count       as float )      ,0) * 100
                 , 2
               )
            END show_click_stb_rate
      FROM (
         SELECT
            DATE_TRUNC('day', log_time) format_dt
             ,action_body.voice_name
             man_text
            ,action_body.config config
            ,action_body.target1 target
              ,count(
                distinct (
                  case
                    when action_id  = 'page_show'  then stb_id
                    else null
                  end
                )
              )  show_stb_count
              , count(
                   distinct (
                     case
                    when action_id  = 'focus.voice_text.button'  then stb_id
                    else null
                  end
                )
              )  focus_stb_count
              , count(
                   distinct (
                     case
                    when action_id  = 'click.voice_text.button'  then stb_id
                    else null
                  end
                )
              )  click_stb_count
                 , sum(
                   case
                  when action_id  = 'page_show'  then 1
                  else 0
                end
              )  show_count
              ,SUM(
                case
                  when action_id  = 'focus.voice_text.button'  then 1
                  else 0
                end
              )  focus_count
              ,SUM(
                case
                  when action_id  = 'click.voice_text.button'  then 1
                  else 0
                end
              )  click_count
          FROM "index-nudge-result-union"
          WHERE
             log_time between '{target_day}T00:00:00.000+09:00' AND '{target_day}T23:59:59.999+09:00'
             and action_body.config in (
                 'break_time'
                ,'assign_contents'
                ,'text'
                ,'search_keyword'
                ,'view_text'
             )
            and stb_id not in ('FF7882CA-086C-11EB-B041-09B554E49A17',
'0044B961-4EC1-11EA-91F5-9D29A492214E',
'008703DB-57A5-11EA-B1D9-BF69B691B61A',
'0088CD1E-5F18-11E9-B4BF-A911074387AC',
'01F605EC-086D-11EB-B041-09B554E49A17',
'02BE0E94-71A3-11EB-B359-7F91959BF123',
'02F07E50-5F18-11E9-B4BF-A911074387AC',
'030A8081-46EB-11EA-91F5-9D29A492214E',
'03B82050-75B9-11EB-B359-7F91959BF123',
'045BEF87-43CA-11EA-819D-37B877ECC397',
'05B7C8DF-086D-11EB-B041-09B554E49A17',
'05BC2C3D-E53A-11E5-A490-FDCFBFF8EC17',
'05D5AED5-71A3-11EB-B359-7F91959BF123',
'0619521A-400C-11EB-8CE9-C9B823C84DEA',
'07D898D4-5F18-11E9-B4BF-A911074387AC',
'090E281B-400C-11EB-8CE9-C9B823C84DEA',
'096AD267-43D2-11EA-819D-37B877ECC397',
'096CEA59-27C7-11EB-9954-191C9BF59F0F',
'09A6EA8B-43CA-11EA-819D-37B877ECC397',
'0A1F7668-4719-11EA-91F5-9D29A492214E',
'0AA37978-43D2-11EA-819D-37B877ECC397',
'0AC007AF-C3B3-11E9-A51A-61AC1B87CDDD',
'0B7399E7-5F18-11E9-B4BF-A911074387AC',
'0BB7E068-46EB-11EA-91F5-9D29A492214E',
'0BDE4369-43D2-11EA-819D-37B877ECC397',
'0C19AFD7-71A3-11EB-B359-7F91959BF123',
'0C1BB63C-400C-11EB-8CE9-C9B823C84DEA',
'0D0E869B-F70E-11EA-BD09-5F5CE34E524C',
'0D1C128E-65C8-11EB-B359-7F91959BF123',
'0DD4B8AD-2A10-11EB-9954-191C9BF59F0F',
'0DD9EB89-5F18-11E9-B4BF-A911074387AC',
'0DDC7E6B-4719-11EA-91F5-9D29A492214E',
'0F075E7A-FC91-11EA-BD09-5F5CE34E524C',
'0FC48F0B-46EB-11EA-91F5-9D29A492214E',
'0FF84CAA-F308-11EA-BD09-5F5CE34E524C',
'10AE54A7-F70C-11EA-BD09-5F5CE34E524C',
'11723323-4E23-11EA-91F5-9D29A492214E',
'128008FC-F308-11EA-BD09-5F5CE34E524C',
'12BBD328-2A0E-11EB-9954-191C9BF59F0F',
'13D1D9EE-46EB-11EA-91F5-9D29A492214E',
'14797AE0-43D2-11EA-819D-37B877ECC397',
'15023C04-8C42-11EB-B359-7F91959BF123',
'15B61991-43D2-11EA-819D-37B877ECC397',
'15BC46AB-F70C-11EA-BD09-5F5CE34E524C',
'17890401-5F18-11E9-B4BF-A911074387AC',
'18C03602-46EB-11EA-91F5-9D29A492214E',
'1956B8B2-463B-11EA-91F5-9D29A492214E',
'1965EC39-8AAC-11EB-B359-7F91959BF123',
'19FC8693-46EB-11EA-91F5-9D29A492214E',
'1A44C5F3-44A8-11E9-B4BF-A911074387AC',
'1A76D0A6-4345-11EA-819D-37B877ECC397',
'1A9FE1C5-43D2-11EA-819D-37B877ECC397',
'1AC219C8-43D3-11EA-819D-37B877ECC397',
'1B73A87C-EF0F-11E4-99A3-FFE65BF43068',
'1C058BF2-72C5-11E9-A51A-61AC1B87CDDD',
'1C73A115-46EB-11EA-91F5-9D29A492214E',
'1C9AE474-5FBE-11EB-A381-BD24EE0CC13B',
'1CC02622-2A10-11EB-9954-191C9BF59F0F',
'1D3CFA83-72C5-11E9-A51A-61AC1B87CDDD',
'1DAF5566-46EB-11EA-91F5-9D29A492214E',
'1E4908B0-27C7-11EB-9954-191C9BF59F0F',
'1EA7C4B2-7E0C-11EA-89C1-C7E5A3E90FFA',
'1F3A4B79-4719-11EA-91F5-9D29A492214E',
'1F8B3099-43D2-11EA-819D-37B877ECC397',
'207B66F5-F161-11E8-A69C-597304835A04',
'21385AA4-7E0C-11EA-89C1-C7E5A3E90FFA',
'21430FAC-DC62-11EA-AF88-B71B51F73ACC',
'21781598-8C42-11EB-B359-7F91959BF123',
'21B2023B-4719-11EA-91F5-9D29A492214E',
'23B19806-7E0C-11EA-89C1-C7E5A3E90FFA',
'2421553E-850B-11EA-89C1-C7E5A3E90FFA',
'2562600E-4719-11EA-91F5-9D29A492214E',
'25B1BE8E-43D2-11EA-819D-37B877ECC397',
'266B78F1-400A-11EB-8CE9-C9B823C84DEA',
'274CE389-F70C-11EA-BD09-5F5CE34E524C',
'276A5A49-7E0C-11EA-89C1-C7E5A3E90FFA',
'28957803-A3AB-11E9-A51A-61AC1B87CDDD',
'28A5996A-7E0C-11EA-89C1-C7E5A3E90FFA',
'2978E764-68B5-11EA-B1D9-BF69B691B61A',
'29875EF2-400A-11EB-8CE9-C9B823C84DEA',
'2A2B4623-D1A8-11E8-A69C-597304835A04',
'2A90E630-2A0E-11EB-9954-191C9BF59F0F',
'2AF91A15-43D3-11EA-819D-37B877ECC397',
'2BF8F3E3-43D2-11EA-819D-37B877ECC397',
'2C5B004D-7E0C-11EA-89C1-C7E5A3E90FFA',
'2CE0CB92-46EB-11EA-91F5-9D29A492214E',
'2D9750DE-7E0C-11EA-89C1-C7E5A3E90FFA',
'2E07F7C5-4719-11EA-91F5-9D29A492214E',
'2E36833A-75DC-11E9-A51A-61AC1B87CDDD',
'2F6D7778-F70D-11EA-BD09-5F5CE34E524C',
'2F7754F4-46EB-11EA-91F5-9D29A492214E',
'2F88579B-75DC-11E9-A51A-61AC1B87CDDD',
'31EC9CA0-72C3-11E9-A51A-61AC1B87CDDD',
'31F13C2A-F70D-11EA-BD09-5F5CE34E524C',
'326E822B-5FBE-11EB-A381-BD24EE0CC13B',
'32C51AAB-43D3-11EA-819D-37B877ECC397',
'32D2FAA5-400A-11EB-8CE9-C9B823C84DEA',
'332DCD47-46EB-11EA-91F5-9D29A492214E',
'33F6B2CB-1991-11EB-9F60-27FFA0C78F0A',
'34502F22-72C3-11E9-A51A-61AC1B87CDDD',
'3597607C-5FBE-11EB-A381-BD24EE0CC13B',
'36A3A46C-4719-11EA-91F5-9D29A492214E',
'36EF1B0A-46EB-11EA-91F5-9D29A492214E',
'378215F5-140B-11EB-B698-F78FAF3A85D1',
'398A80F3-7783-11E9-A51A-61AC1B87CDDD',
'399D3B5E-43D2-11EA-819D-37B877ECC397',
'39C0CC57-749F-11EA-89C1-C7E5A3E90FFA',
'3A5F17C3-D154-11EA-AF88-B71B51F73ACC',
'3A892A10-8C42-11EB-B359-7F91959BF123',
'3B834B18-72C3-11E9-A51A-61AC1B87CDDD',
'3B90A0F0-4719-11EA-91F5-9D29A492214E',
'3BA3F2BB-A8D6-11EB-A8A9-4967C6636A82',
'3C2E9BE8-400A-11EB-8CE9-C9B823C84DEA',
'3CE69499-4345-11EA-819D-37B877ECC397',
'3DC6092C-38B7-11E9-B4BF-A911074387AC',
'3E25080A-4345-11EA-819D-37B877ECC397',
'3F461519-400A-11EB-8CE9-C9B823C84DEA',
'40E98CB2-8C42-11EB-B359-7F91959BF123',
'41D1809C-24C8-11EB-B81F-F3C72B473E8E',
'41E1D157-43D3-11EA-819D-37B877ECC397',
'41EEC697-2A11-11EB-9954-191C9BF59F0F',
'4250DBD5-43D2-11EA-819D-37B877ECC397',
'42928F61-432A-11EA-819D-37B877ECC397',
'44C2C637-43D2-11EA-819D-37B877ECC397',
'4512A1DD-24C8-11EB-B81F-F3C72B473E8E',
'451636E8-A817-11EB-A8A9-4967C6636A82',
'451FF362-A09E-11EA-89C1-C7E5A3E90FFA',
'45509609-2A0E-11EB-9954-191C9BF59F0F',
'456129C4-72C5-11E9-A51A-61AC1B87CDDD',
'4568F98B-400A-11EB-8CE9-C9B823C84DEA',
'456BAB68-4719-11EA-91F5-9D29A492214E',
'4617F76A-F70E-11EA-BD09-5F5CE34E524C',
'465B4D62-6342-11E8-92CC-37284F68FBAD',
'472C2E24-8C42-11EB-B359-7F91959BF123',
'475643CB-F70E-11EA-BD09-5F5CE34E524C',
'47DA6E69-2A11-11EB-9954-191C9BF59F0F',
'48A7EA43-DFFB-11E9-AF77-B9B309A920DB',
'49330661-079E-11EB-BD09-5F5CE34E524C',
'4A343C14-2003-11EB-B81F-F3C72B473E8E',
'4B3B52AF-24C8-11EB-B81F-F3C72B473E8E',
'4B8C050D-400A-11EB-8CE9-C9B823C84DEA',
'4B97DEAD-4719-11EA-91F5-9D29A492214E',
'4CFCB1BD-F3E5-11E9-819D-37B877ECC397',
'4D4302B5-2003-11EB-B81F-F3C72B473E8E',
'4D68AC0E-43D2-11EA-819D-37B877ECC397',
'4DCCF40B-2A11-11EB-9954-191C9BF59F0F',
'4EA3EB2F-43D2-11EA-819D-37B877ECC397',
'4FBD58D2-D1A8-11E8-A69C-597304835A04',
'5139E70D-2A0E-11EB-9954-191C9BF59F0F',
'51CDC098-EBD5-11E8-A69C-597304835A04',
'51E3B988-BA9A-11EA-AB15-C57A43B26EA7',
'52524D32-43D2-11EA-819D-37B877ECC397',
'538689CF-20A5-11EA-B079-576187D2117C',
'53A31023-43D2-11EA-819D-37B877ECC397',
'53BDB898-46B8-11E9-B4BF-A911074387AC',
'54F265EF-2A0F-11EB-9954-191C9BF59F0F',
'55A5CDC4-8DC3-11EA-89C1-C7E5A3E90FFA',
'55AF678B-BA9A-11EA-AB15-C57A43B26EA7',
'563DB9A7-F70E-11EA-BD09-5F5CE34E524C',
'56B78519-8C42-11EB-B359-7F91959BF123',
'56D707CC-43D1-11EA-819D-37B877ECC397',
'570D0970-14CB-11EA-8A0F-6B0B99858FC5',
'5790FEFE-A8D6-11EB-A8A9-4967C6636A82',
'5799FEC3-43D0-11EA-819D-37B877ECC397',
'57A359F8-F70D-11EA-BD09-5F5CE34E524C',
'58E3C939-F70D-11EA-BD09-5F5CE34E524C',
'597744FE-BA9A-11EA-AB15-C57A43B26EA7',
'599D77E5-96AE-11EB-A381-BD24EE0CC13B',
'5A7E4355-1FE8-11EB-B81F-F3C72B473E8E',
'5ACE76BF-A8D6-11EB-A8A9-4967C6636A82',
'5B3F4F9B-F70E-11EA-BD09-5F5CE34E524C',
'5B82893E-6A50-11E9-B4BF-A911074387AC',
'5BBE10E0-43D1-11EA-819D-37B877ECC397',
'5C5A5B1A-43D2-11EA-819D-37B877ECC397',
'5C7C4E01-7499-11EA-89C1-C7E5A3E90FFA',
'5C9CFAD0-4BEF-11EA-91F5-9D29A492214E',
'5CBC68CF-6A50-11E9-B4BF-A911074387AC',
'5D7B01E0-46B8-11E9-B4BF-A911074387AC',
'5D943AAB-43D2-11EA-819D-37B877ECC397',
'5DCA29A8-43D0-11EA-819D-37B877ECC397',
'5E0A8EF0-A8D6-11EB-A8A9-4967C6636A82',
'5E85FE60-1CB5-11EB-9F60-27FFA0C78F0A',
'5F63355B-2003-11EB-B81F-F3C72B473E8E',
'5F6DAB63-43D1-11EA-819D-37B877ECC397',
'5FE87F72-46B8-11E9-B4BF-A911074387AC',
'60AB6008-43CA-11EA-819D-37B877ECC397',
'60D9E233-2A0F-11EB-9954-191C9BF59F0F',
'60E6043E-67FB-11E9-B4BF-A911074387AC',
'60EF3224-BA9A-11EA-AB15-C57A43B26EA7',
'61155BD2-1CB5-11EB-9F60-27FFA0C78F0A',
'61174E24-400A-11EB-8CE9-C9B823C84DEA',
'61276E8E-4719-11EA-91F5-9D29A492214E',
'61726B8F-6A4F-11E9-B4BF-A911074387AC',
'6249B7D3-57A5-11EA-B1D9-BF69B691B61A',
'6257EDF3-1CB5-11EB-9F60-27FFA0C78F0A',
'62592E34-4BEF-11EA-91F5-9D29A492214E',
'62787255-079E-11EB-BD09-5F5CE34E524C',
'6299FC1F-6D5F-11E9-BD6D-EF3D58CBAF2C',
'62BDF8F8-81BD-11E9-A51A-61AC1B87CDDD',
'62CA37D4-850D-11EA-89C1-C7E5A3E90FFA',
'63211676-43D1-11EA-819D-37B877ECC397',
'63249D6A-43CA-11EA-819D-37B877ECC397',
'6481B8FB-5FBE-11EB-A381-BD24EE0CC13B',
'64BEE6B6-46B8-11E9-B4BF-A911074387AC',
'657243AD-2003-11EB-B81F-F3C72B473E8E',
'659A53D8-43D1-11EA-819D-37B877ECC397',
'65B0AEC5-46EE-11EA-91F5-9D29A492214E',
'66D8A039-43D1-11EA-819D-37B877ECC397',
'675F035F-43D0-11EA-819D-37B877ECC397',
'67C985E3-A8D6-11EB-A8A9-4967C6636A82',
'6812CDEA-43D1-11EA-819D-37B877ECC397',
'682669B7-46EE-11EA-91F5-9D29A492214E',
'6889D7E4-4719-11EA-91F5-9D29A492214E',
'69036155-2A0E-11EB-9954-191C9BF59F0F',
'693D45C9-2EBA-11EB-9628-0FF1661CFF78',
'69680E65-67FB-11E9-B4BF-A911074387AC',
'69D9C3D8-D1A8-11E8-A69C-597304835A04',
'6A18AACA-6A50-11E9-B4BF-A911074387AC',
'6A2BF82C-EAFE-11E9-819D-37B877ECC397',
'6A414B7D-DFFB-11E9-AF77-B9B309A920DB',
'6A9FA406-67FB-11E9-B4BF-A911074387AC',
'6B3AA07C-4345-11EA-819D-37B877ECC397',
'6B62554D-EAFE-11E9-819D-37B877ECC397',
'6B7A742F-2003-11EB-B81F-F3C72B473E8E',
'6B7CE38A-47B9-11EA-B1D9-BF69B691B61A',
'6BD4EFB7-67FB-11E9-B4BF-A911074387AC',
'6CF40A9E-43D1-11EA-819D-37B877ECC397',
'6D0BC208-67FB-11E9-B4BF-A911074387AC',
'6D36BA5C-6D5D-11E9-B4BF-A911074387AC',
'6D85D4B8-400A-11EB-8CE9-C9B823C84DEA',
'6D93E2AC-57A5-11EA-B1D9-BF69B691B61A',
'6DFC4A1F-51F1-11EA-B1D9-BF69B691B61A',
'6E1604FC-47B9-11EA-B1D9-BF69B691B61A',
'6E4FC005-A8D6-11EB-A8A9-4967C6636A82',
'6F76CE9A-67FB-11E9-B4BF-A911074387AC',
'6FA8876C-7765-11EB-B359-7F91959BF123',
'6FAA4FBF-46B8-11E9-B4BF-A911074387AC',
'704789A1-EAFE-11E9-819D-37B877ECC397',
'707A9091-51F1-11EA-B1D9-BF69B691B61A',
'70B0600B-67FB-11E9-B4BF-A911074387AC',
'710FA120-46EB-11EA-91F5-9D29A492214E',
'7184A081-2003-11EB-B81F-F3C72B473E8E',
'71860BD6-A8D6-11EB-A8A9-4967C6636A82',
'7196D6B1-079E-11EB-BD09-5F5CE34E524C',
'71B9A042-51F1-11EA-B1D9-BF69B691B61A',
'726EDF12-BA9A-11EA-AB15-C57A43B26EA7',
'72F92523-51F1-11EA-B1D9-BF69B691B61A',
'7319E5FD-67FB-11E9-B4BF-A911074387AC',
'746D75A4-51F1-11EA-B1D9-BF69B691B61A',
'748165C2-2003-11EB-B81F-F3C72B473E8E',
'74ADFEE9-43D0-11EA-819D-37B877ECC397',
'74FF74AF-6A4F-11E9-B4BF-A911074387AC',
'750ED6D9-1375-11EB-B041-09B554E49A17',
'752A4CF5-EAFE-11E9-819D-37B877ECC397',
'753F3DB7-DF2A-11E9-AF77-B9B309A920DB',
'75ACFA85-51F1-11EA-B1D9-BF69B691B61A',
'75DF2C86-72C3-11E9-A51A-61AC1B87CDDD',
'763B9D43-57A5-11EA-B1D9-BF69B691B61A',
'76882EDB-4337-11EA-819D-37B877ECC397',
'76C49F2B-400A-11EB-8CE9-C9B823C84DEA',
'770EA1E6-47BD-11EA-B1D9-BF69B691B61A',
'777CADF5-46EB-11EA-91F5-9D29A492214E',
'77F15279-43CA-11EA-819D-37B877ECC397',
'78BACE15-57A5-11EA-B1D9-BF69B691B61A',
'790C1612-8C41-11EB-B359-7F91959BF123',
'796399E8-51F1-11EA-B1D9-BF69B691B61A',
'79E2B877-6A50-11E9-B4BF-A911074387AC',
'79E9FD75-46EE-11EA-91F5-9D29A492214E',
'79F57627-46EB-11EA-91F5-9D29A492214E',
'7A2A8033-A8D8-11EB-A8A9-4967C6636A82',
'7A66983B-43CA-11EA-819D-37B877ECC397',
'7B9F183C-43CA-11EA-819D-37B877ECC397',
'7BB3861A-43D1-11EA-819D-37B877ECC397',
'7BC40248-6D5D-11E9-B4BF-A911074387AC',
'7C83006C-CD4C-11EA-AF88-B71B51F73ACC',
'7CC4A945-7011-11EB-B359-7F91959BF123',
'7CD85B8D-43CA-11EA-819D-37B877ECC397',
'7D590FC5-6D5F-11E9-BD6D-EF3D58CBAF2C',
'7D82FB73-DF29-11E9-AF77-B9B309A920DB',
'7DDC4819-57A5-11EA-B1D9-BF69B691B61A',
'7E11C5EE-43CA-11EA-819D-37B877ECC397',
'7E47E693-7014-11EB-B359-7F91959BF123',
'7EAF3EAA-42FB-11EA-819D-37B877ECC397',
'7ED734F1-57A3-11EA-B1D9-BF69B691B61A',
'7EF18F31-43D0-11EA-819D-37B877ECC397',
'7EFEE4B3-E118-11EA-BD09-5F5CE34E524C',
'7FE28B16-7011-11EB-B359-7F91959BF123',
'804E8722-43D0-11EA-819D-37B877ECC397',
'81071106-10E4-11E5-B08D-4D8BBBC9A3BE',
'8195FD6E-51F1-11EA-B1D9-BF69B691B61A',
'81CEA6E1-43CA-11EA-819D-37B877ECC397',
'81CFEEAB-46EE-11EA-91F5-9D29A492214E',
'828F8204-57A3-11EA-B1D9-BF69B691B61A',
'832BABAF-400A-11EB-8CE9-C9B823C84DEA',
'83A001BF-6A50-11E9-B4BF-A911074387AC',
'83CB5D65-57A3-11EA-B1D9-BF69B691B61A',
'83E725C6-463B-11EA-91F5-9D29A492214E',
'84173071-3768-11EA-819D-37B877ECC397',
'844BF22F-46EB-11EA-91F5-9D29A492214E',
'846150E2-72C3-11E9-A51A-61AC1B87CDDD',
'8463C145-43D0-11EA-819D-37B877ECC397',
'8468A570-51F1-11EA-B1D9-BF69B691B61A',
'847BEC93-43CA-11EA-819D-37B877ECC397',
'8521EFB7-463B-11EA-91F5-9D29A492214E',
'858CAF90-46EB-11EA-91F5-9D29A492214E',
'85A23FA2-43D1-11EA-819D-37B877ECC397',
'85FCDA01-51F1-11EA-B1D9-BF69B691B61A',
'8648B977-57A3-11EA-B1D9-BF69B691B61A',
'86AFCDA0-57A5-11EA-B1D9-BF69B691B61A',
'86C8D911-46EB-11EA-91F5-9D29A492214E',
'8789349B-DF29-11E9-AF77-B9B309A920DB',
'87F42052-6D5D-11E9-B4BF-A911074387AC',
'87FCEE35-72C3-11E9-A51A-61AC1B87CDDD',
'88065B20-46EE-11EA-91F5-9D29A492214E',
'88AEC597-8C41-11EB-B359-7F91959BF123',
'88C663A9-57A3-11EA-B1D9-BF69B691B61A',
'88C6E4BC-DF29-11E9-AF77-B9B309A920DB',
'88D108A3-51F1-11EA-B1D9-BF69B691B61A',
'89636AD7-43CA-11EA-819D-37B877ECC397',
'89A4F6F3-46EB-11EA-91F5-9D29A492214E',
'8A04D71A-57A3-11EA-B1D9-BF69B691B61A',
'8A825FFA-43D0-11EA-819D-37B877ECC397',
'8B37CBF4-46EB-11EA-91F5-9D29A492214E',
'8C718475-46EB-11EA-91F5-9D29A492214E',
'8CADE79A-2003-11EB-B81F-F3C72B473E8E',
'8CF1ABC5-57A5-11EA-B1D9-BF69B691B61A',
'8D09686A-43CA-11EA-819D-37B877ECC397',
'8EEDA05B-8C42-11EB-B359-7F91959BF123',
'8EEF4571-57A4-11EA-B1D9-BF69B691B61A',
'8EFD936E-57A3-11EA-B1D9-BF69B691B61A',
'9029C342-DF29-11E9-AF77-B9B309A920DB',
'90346FA2-57A4-11EA-B1D9-BF69B691B61A',
'90A7BCE3-2A0F-11EB-9954-191C9BF59F0F',
'91386B71-97B1-11E9-A51A-61AC1B87CDDD',
'915E2493-DF29-11E9-AF77-B9B309A920DB',
'91DEE0CC-43D1-11EA-819D-37B877ECC397',
'925ADAE2-81CC-11E9-A51A-61AC1B87CDDD',
'92BB8FB4-57A4-11EA-B1D9-BF69B691B61A',
'92D95783-224F-11EB-B81F-F3C72B473E8E',
'930BE2DA-46EB-11EA-91F5-9D29A492214E',
'9316013D-43D1-11EA-819D-37B877ECC397',
'93CE0B1F-43CA-11EA-819D-37B877ECC397',
'944D21AE-43D1-11EA-819D-37B877ECC397',
'94F9CEA3-633F-11EA-89C1-C7E5A3E90FFA',
'95105E6A-46EE-11EA-91F5-9D29A492214E',
'95412926-57A4-11EA-B1D9-BF69B691B61A',
'954639B3-2A11-11EB-9954-191C9BF59F0F',
'955179B9-47EC-11EA-B1D9-BF69B691B61A',
'9581D11F-43D1-11EA-819D-37B877ECC397',
'95ADC8AF-4345-11EA-819D-37B877ECC397',
'95DCFF0C-57A5-11EA-B1D9-BF69B691B61A',
'96310F72-DC60-11EA-AF88-B71B51F73ACC',
'968E63A1-43CA-11EA-819D-37B877ECC397',
'968F8CB3-43D0-11EA-819D-37B877ECC397',
'96C5415D-46EB-11EA-91F5-9D29A492214E',
'9720547D-57A5-11EA-B1D9-BF69B691B61A',
'97CB6814-43D0-11EA-819D-37B877ECC397',
'97CC8EF8-57A4-11EA-B1D9-BF69B691B61A',
'97F6C8C1-43D1-11EA-819D-37B877ECC397',
'986641FE-57A5-11EA-B1D9-BF69B691B61A',
'98B45DB6-400A-11EB-8CE9-C9B823C84DEA',
'98D9E6E5-224F-11EB-B81F-F3C72B473E8E',
'98DE32F3-DF2A-11E9-AF77-B9B309A920DB',
'99A810CF-57A5-11EA-B1D9-BF69B691B61A',
'9A42E024-43CA-11EA-819D-37B877ECC397',
'9A462C06-1AB6-11E8-AD34-21E42E7495CA',
'9AE3A496-43D0-11EA-819D-37B877ECC397',
'9AEC0280-57A5-11EA-B1D9-BF69B691B61A',
'9B957DDB-57A4-11EA-B1D9-BF69B691B61A',
'9BA0BDF4-43D1-11EA-819D-37B877ECC397',
'9BC53BC7-17C2-11EA-819D-37B877ECC397',
'9C0E6EA3-6A50-11E9-B4BF-A911074387AC',
'9C228D37-43D0-11EA-819D-37B877ECC397',
'9C2F30E1-57A5-11EA-B1D9-BF69B691B61A',
'9C8EB7D6-DF2A-11E9-AF77-B9B309A920DB',
'9D725F42-57A5-11EA-B1D9-BF69B691B61A',
'9DD40571-46EE-11EA-91F5-9D29A492214E',
'9E289513-46EB-11EA-91F5-9D29A492214E',
'9E4247D1-78BC-11EA-89C1-C7E5A3E90FFA',
'9EC31DC0-2003-11EB-B81F-F3C72B473E8E',
'9ECFA108-400A-11EB-8CE9-C9B823C84DEA',
'9EEDAB8E-DF29-11E9-AF77-B9B309A920DB',
'9EF1B2C9-43D0-11EA-819D-37B877ECC397',
'9F370898-43CA-11EA-819D-37B877ECC397',
'9F44D5C1-6D5F-11E9-BD6D-EF3D58CBAF2C',
'9FF900D8-6A4E-11E9-B4BF-A911074387AC',
'A026047F-DF29-11E9-AF77-B9B309A920DB',
'A0726EC9-43CA-11EA-819D-37B877ECC397',
'A1691B6B-43D0-11EA-819D-37B877ECC397',
'A17E3195-FC95-11EA-BD09-5F5CE34E524C',
'A18EAF56-72C4-11E9-A51A-61AC1B87CDDD',
'A19AE55D-57A3-11EA-B1D9-BF69B691B61A',
'A1C2DF19-43D1-11EA-819D-37B877ECC397',
'A1C428C1-2003-11EB-B81F-F3C72B473E8E',
'A1DCC376-46EB-11EA-91F5-9D29A492214E',
'A1E0D878-224F-11EB-B81F-F3C72B473E8E',
'A20FF1A4-78BC-11EA-89C1-C7E5A3E90FFA',
'A2EB6B7E-4704-11EA-91F5-9D29A492214E',
'A31B3BBA-24F1-11E9-A69C-597304835A04',
'A36BAC59-4711-11EA-91F5-9D29A492214E',
'A42AEA34-496D-11EA-91F5-9D29A492214E',
'A45A94B8-46EB-11EA-91F5-9D29A492214E',
'A482F041-463F-11EA-91F5-9D29A492214E',
'A53D4053-FC96-11EA-BD09-5F5CE34E524C',
'A5504C40-57A3-11EA-B1D9-BF69B691B61A',
'A5933BC9-46EB-11EA-91F5-9D29A492214E',
'A594C73C-24F1-11E9-A69C-597304835A04',
'A706B05B-7578-11EA-B1D9-BF69B691B61A',
'A70811B8-78BC-11EA-89C1-C7E5A3E90FFA',
'A70DDE9E-43CA-11EA-819D-37B877ECC397',
'A74E07CE-DF2A-11E9-AF77-B9B309A920DB',
'A8B5F156-DF29-11E9-AF77-B9B309A920DB',
'A8BC520B-1374-11EB-B041-09B554E49A17',
'A92CCE48-496D-11EA-91F5-9D29A492214E',
'A92F2C0F-24F1-11E9-A69C-597304835A04',
'A94EE43C-46EB-11EA-91F5-9D29A492214E',
'A9C9F2E8-C3D7-11E9-8A0F-6B0B99858FC5',
'AA600AF0-24F1-11E9-A69C-597304835A04',
'AB05A29D-F70D-11EA-BD09-5F5CE34E524C',
'AB929781-24F1-11E9-A69C-597304835A04',
'AC9DF3B0-2005-11EB-B81F-F3C72B473E8E',
'ACCC01E2-24F1-11E9-A69C-597304835A04',
'ACED11B0-6F03-11E4-9B67-FDF5B9EF72F1',
'AD2DF32F-46EB-11EA-91F5-9D29A492214E',
'AD5F16A4-43D0-11EA-819D-37B877ECC397',
'AD8B054C-2A0E-11EB-9954-191C9BF59F0F',
'ADADA54F-57A5-11EA-B1D9-BF69B691B61A',
'ADFDF233-24F1-11E9-A69C-597304835A04',
'AE013723-8C41-11EB-B359-7F91959BF123',
'AE2674FC-496D-11EA-91F5-9D29A492214E',
'AE6B5530-46EB-11EA-91F5-9D29A492214E',
'AE8F60AD-2A0F-11EB-9954-191C9BF59F0F',
'AEFF41A0-1374-11EB-B041-09B554E49A17',
'AF2E0DC4-24F1-11E9-A69C-597304835A04',
'AF3C46A8-57A3-11EA-B1D9-BF69B691B61A',
'AF67596D-496D-11EA-91F5-9D29A492214E',
'AFB15275-43CA-11EA-819D-37B877ECC397',
'AFF911CF-6D5E-11E9-B4BF-A911074387AC',
'B026E2B1-57A5-11EA-B1D9-BF69B691B61A',
'B04064A6-43D0-11EA-819D-37B877ECC397',
'B05FFE15-24F1-11E9-A69C-597304835A04',
'B09526CC-FC96-11EA-BD09-5F5CE34E524C',
'B0A382EE-496D-11EA-91F5-9D29A492214E',
'B10592C8-4318-11EA-819D-37B877ECC397',
'B18F5656-24F1-11E9-A69C-597304835A04',
'B28F9123-F70D-11EA-BD09-5F5CE34E524C',
'B2F7A0FB-57A3-11EA-B1D9-BF69B691B61A',
'B3AA590E-57A4-11EA-B1D9-BF69B691B61A',
'B3FF44E8-24F1-11E9-A69C-597304835A04',
'B437E92C-57A3-11EA-B1D9-BF69B691B61A',
'B4EA2C0F-57A4-11EA-B1D9-BF69B691B61A',
'B52EEB49-24F1-11E9-A69C-597304835A04',
'B53AA2E9-DF2A-11E9-AF77-B9B309A920DB',
'B5882B5A-43D0-11EA-819D-37B877ECC397',
'B6E13336-FC95-11EA-BD09-5F5CE34E524C',
'B78E5A47-46EB-11EA-91F5-9D29A492214E',
'B78F979B-24F1-11E9-A69C-597304835A04',
'B78FC787-F70D-11EA-BD09-5F5CE34E524C',
'B7910B5D-C3AF-11E9-A51A-61AC1B87CDDD',
'B7D4EA07-1374-11EB-B041-09B554E49A17',
'B805123C-43D0-11EA-819D-37B877ECC397',
'B846D04D-7013-11EB-B359-7F91959BF123',
'B86CAF8F-98E3-11EA-89C1-C7E5A3E90FFA',
'B8B12123-DF29-11E9-AF77-B9B309A920DB',
'B8B2F3E2-57A4-11EA-B1D9-BF69B691B61A',
'B8CB4718-46EB-11EA-91F5-9D29A492214E',
'B96482B8-FC95-11EA-BD09-5F5CE34E524C',
'BA373660-98E3-11EA-89C1-C7E5A3E90FFA',
'BB2E422E-24F1-11E9-A69C-597304835A04',
'BB56F5DA-57A5-11EA-B1D9-BF69B691B61A',
'BC2A13F7-A3AB-11E9-A51A-61AC1B87CDDD',
'BC5F963F-24F1-11E9-A69C-597304835A04',
'BC6E11AF-43D0-11EA-819D-37B877ECC397',
'BC8CA28B-F70D-11EA-BD09-5F5CE34E524C',
'BC95B76B-57A5-11EA-B1D9-BF69B691B61A',
'BD8FFFF0-24F1-11E9-A69C-597304835A04',
'BEBDAA81-24F1-11E9-A69C-597304835A04',
'BEE143DD-6F76-11EB-B359-7F91959BF123',
'BEFBD6E7-57A4-11EA-B1D9-BF69B691B61A',
'BF1B50DD-57A5-11EA-B1D9-BF69B691B61A',
'BF935431-4612-11E9-B4BF-A911074387AC',
'BFCEA6B0-508E-11E9-B4BF-A911074387AC',
'C03C7D7E-46EB-11EA-91F5-9D29A492214E',
'C03D7EA8-57A4-11EA-B1D9-BF69B691B61A',
'C0BA4E69-8C41-11EB-B359-7F91959BF123',
'C105C721-508E-11E9-B4BF-A911074387AC',
'C11AAD53-24F1-11E9-A69C-597304835A04',
'C17E9A6F-46EB-11EA-91F5-9D29A492214E',
'C194B5F0-7013-11EB-B359-7F91959BF123',
'C1A44D72-FCB5-11E7-921D-796CB4E9FDD3',
'C1B1E0C3-43D0-11EA-819D-37B877ECC397',
'C1BB4745-C3AF-11E9-A51A-61AC1B87CDDD',
'C20D8B22-2A11-11EB-9954-191C9BF59F0F',
'C24AC8E4-24F1-11E9-A69C-597304835A04',
'C25892F8-FADA-11E9-819D-37B877ECC397',
'C2BE4660-46EB-11EA-91F5-9D29A492214E',
'C404E6EB-57A4-11EA-B1D9-BF69B691B61A',
'C41F30C1-57A5-11EA-B1D9-BF69B691B61A',
'C427C2C5-43D0-11EA-819D-37B877ECC397',
'C44D71E1-46EB-11EA-91F5-9D29A492214E',
'C4B27A16-24F1-11E9-A69C-597304835A04',
'C54D8A72-F70D-11EA-BD09-5F5CE34E524C',
'C55DA432-57A5-11EA-B1D9-BF69B691B61A',
'C5643A66-43D0-11EA-819D-37B877ECC397',
'C56EBE54-2A0E-11EB-9954-191C9BF59F0F',
'C80CAFB3-463F-11EA-91F5-9D29A492214E',
'C8462987-508E-11E9-B4BF-A911074387AC',
'C85C05E0-6F76-11EB-B359-7F91959BF123',
'C900C233-9357-11EB-A381-BD24EE0CC13B',
'C91547EE-81CB-11E9-A51A-61AC1B87CDDD',
'C951ABCD-57A3-11EA-B1D9-BF69B691B61A',
'C9935090-FC96-11EA-BD09-5F5CE34E524C',
'CA582A30-57A4-11EA-B1D9-BF69B691B61A',
'CA5BEC60-FB08-11E5-A490-FDCFBFF8EC17',
'CB083266-FC95-11EA-BD09-5F5CE34E524C',
'CB140222-DF29-11E9-AF77-B9B309A920DB',
'CC9AE987-65F1-11EB-A381-BD24EE0CC13B',
'CCE190AA-AFEB-11E8-91DB-D7214634FC50',
'CD0277BD-24F1-11E9-A69C-597304835A04',
'CD14147D-8C41-11EB-B359-7F91959BF123',
'CD609878-46EB-11EA-91F5-9D29A492214E',
'CD9EE198-4BEF-11EA-91F5-9D29A492214E',
'CE12A539-57A5-11EA-B1D9-BF69B691B61A',
'CE1D222C-4328-11EA-819D-37B877ECC397',
'CE1F3B39-F70D-11EA-BD09-5F5CE34E524C',
'CE286C13-57A4-11EA-B1D9-BF69B691B61A',
'CE6EAB07-2A0E-11EB-9954-191C9BF59F0F',
'CEE0D779-4BEF-11EA-91F5-9D29A492214E',
'CF646EC5-496D-11EA-91F5-9D29A492214E',
'CF7221BF-B9AF-11EA-AB15-C57A43B26EA7',
'CFB1C678-65F1-11EB-A381-BD24EE0CC13B',
'D0FF7A45-4EC1-11EA-91F5-9D29A492214E',
'D118E58B-46EB-11EA-91F5-9D29A492214E',
'D16E0858-2A0E-11EB-9954-191C9BF59F0F',
'D179574C-5FBD-11EB-A381-BD24EE0CC13B',
'D32EC30C-46EA-11EA-91F5-9D29A492214E',
'D3E5129F-8A4D-11E8-A615-3D13A2F74E21',
'D40DF8C1-43D2-11EA-819D-37B877ECC397',
'D5476322-43D2-11EA-819D-37B877ECC397',
'D5729C7D-3FB1-11E9-B4BF-A911074387AC',
'D5ED14EA-65F1-11EB-A381-BD24EE0CC13B',
'D66CF6A0-8C41-11EB-B359-7F91959BF123',
'D6904370-6A4F-11E9-B4BF-A911074387AC',
'D6F3EB8F-46EB-11EA-91F5-9D29A492214E',
'D76F0CEA-2A0E-11EB-9954-191C9BF59F0F',
'D7D8E656-C3AF-11E9-A51A-61AC1B87CDDD',
'D816F3A9-57A3-11EA-B1D9-BF69B691B61A',
'D82116C0-46EA-11EA-91F5-9D29A492214E',
'D82DF230-46EB-11EA-91F5-9D29A492214E',
'D8366454-6D5D-11E9-B4BF-A911074387AC',
'D89E5405-53A7-11EA-B1D9-BF69B691B61A',
'D96A42C1-46EB-11EA-91F5-9D29A492214E',
'D990FA71-46EA-11EA-91F5-9D29A492214E',
'DA8A64AB-57A3-11EA-B1D9-BF69B691B61A',
'DAA7CBD2-46EB-11EA-91F5-9D29A492214E',
'DAC75CC0-8418-11E8-A615-3D13A2F74E21',
'DBC7517C-57A3-11EA-B1D9-BF69B691B61A',
'DC09E9B3-46EA-11EA-91F5-9D29A492214E',
'DCACB1E2-8C41-11EB-B359-7F91959BF123',
'DD04B37D-57A3-11EA-B1D9-BF69B691B61A',
'DE3F8A8B-C3AF-11E9-A51A-61AC1B87CDDD',
'DE8BCA76-F70D-11EA-BD09-5F5CE34E524C',
'E1B003DB-DF2A-11E9-AF77-B9B309A920DB',
'E1E458E1-0C44-11EB-A802-038801CE606F',
'E1F30F91-57A3-11EA-B1D9-BF69B691B61A',
'E258E123-57A4-11EA-B1D9-BF69B691B61A',
'E3A2BD2A-F70D-11EA-BD09-5F5CE34E524C',
'E3BDA184-496D-11EA-91F5-9D29A492214E',
'E41F83B4-98E3-11EA-89C1-C7E5A3E90FFA',
'E446A6BD-43D2-11EA-819D-37B877ECC397',
'E4D579E5-57A4-11EA-B1D9-BF69B691B61A',
'E5A3BB84-57A3-11EA-B1D9-BF69B691B61A',
'E5AB468A-46EA-11EA-91F5-9D29A492214E',
'E614D7B6-57A4-11EA-B1D9-BF69B691B61A',
'E6DF6FD5-57A3-11EA-B1D9-BF69B691B61A',
'E77922E7-496D-11EA-91F5-9D29A492214E',
'E829B40C-46EA-11EA-91F5-9D29A492214E',
'E886A088-4BF1-11EA-91F5-9D29A492214E',
'E899D4E8-57A4-11EA-B1D9-BF69B691B61A',
'E95CA4D7-57A3-11EA-B1D9-BF69B691B61A',
'E997ACDF-A3AA-11E9-A51A-61AC1B87CDDD',
'EA9AA318-57A3-11EA-B1D9-BF69B691B61A',
'EBDA4F09-57A3-11EA-B1D9-BF69B691B61A',
'EC011B23-43D2-11EA-819D-37B877ECC397',
'EC5BEDEA-F70B-11EA-BD09-5F5CE34E524C',
'EC70CD8B-57A4-11EA-B1D9-BF69B691B61A',
'ECFB838D-774F-11EB-B359-7F91959BF123',
'ED262CB2-2A0F-11EB-9954-191C9BF59F0F',
'ED275260-46EA-11EA-91F5-9D29A492214E',
'EDEE21C8-7786-11E9-A51A-61AC1B87CDDD',
'EDFCCD7C-086C-11EB-B041-09B554E49A17',
'EE55130B-57A3-11EA-B1D9-BF69B691B61A',
'EF0F7A95-46E7-11EA-91F5-9D29A492214E',
'EF9BADC2-46EA-11EA-91F5-9D29A492214E',
'EFEE2AAA-43C6-11EA-819D-37B877ECC397',
'F0793F2E-086C-11EB-B041-09B554E49A17',
'F0D6C5D3-46EA-11EA-91F5-9D29A492214E',
'F2763E48-43D2-11EA-819D-37B877ECC397',
'F312374D-5176-11EB-8CE9-C9B823C84DEA',
'F36042E6-FC95-11EA-BD09-5F5CE34E524C',
'F3A74AF5-46EA-11EA-91F5-9D29A492214E',
'F3D3D7E8-428D-11EA-819D-37B877ECC397',
'F549EE48-F70D-11EA-BD09-5F5CE34E524C',
'F63FF07B-43D2-11EA-819D-37B877ECC397',
'F7022508-43D1-11EA-819D-37B877ECC397',
'F70B48D4-E8BF-11E9-AF77-B9B309A920DB',
'F76A4668-46EA-11EA-91F5-9D29A492214E',
'F7A68DF3-F70B-11EA-BD09-5F5CE34E524C',
'F7F3824A-34B0-11E9-B4BF-A911074387AC',
'F8730E0A-4BF2-11EA-91F5-9D29A492214E',
'F8B8DFBD-43D2-11EA-819D-37B877ECC397',
'FA489E0C-F70D-11EA-BD09-5F5CE34E524C',
'FA795887-5C31-11E9-B4BF-A911074387AC',
'FB535959-24C6-11EB-B81F-F3C72B473E8E',
'FBB1D888-5C31-11E9-B4BF-A911074387AC',
'FCAD7B17-F70B-11EA-BD09-5F5CE34E524C',
'FDD3F501-2A0D-11EB-9954-191C9BF59F0F',
'FF54F28E-46EA-11EA-91F5-9D29A492214E',
'FF7882CA-086C-11EB-B041-09B554E49A17',
'83E725C6-463B-11EA-91F5-9D29A492214E',
'8521EFB7-463B-11EA-91F5-9D29A492214E',
'398A80F3-7783-11E9-A51A-61AC1B87CDDD',
'538689CF-20A5-11EA-B079-576187D2117C',
'EDEE21C8-7786-11E9-A51A-61AC1B87CDDD',
'E119E6E9-C4BF-11EA-AB15-C57A43B26EA7',
'61155BD2-1CB5-11EB-9F60-27FFA0C78F0A',
'6257EDF3-1CB5-11EB-9F60-27FFA0C78F0A',
'5FCF2031-1CB5-11EB-9F60-27FFA0C78F0A',
'639ACE34-1CB5-11EB-9F60-27FFA0C78F0A',
'3600C7E2-E205-11E1-B0BA-CB04E4C80DE8',
'80161F6C-9E5A-11EA-89C1-C7E5A3E90FFA',
'955179B9-47EC-11EA-B1D9-BF69B691B61A',
'BA373660-98E3-11EA-89C1-C7E5A3E90FFA',
'62BDF8F8-81BD-11E9-A51A-61AC1B87CDDD',
'91386B71-97B1-11E9-A51A-61AC1B87CDDD',
'8FEC9240-43C7-11EA-819D-37B877ECC397',
'E135D6CE-2A0F-11EB-9954-191C9BF59F0F',
'5E85FE60-1CB5-11EB-9F60-27FFA0C78F0A',
'E1E458E1-0C44-11EB-A802-038801CE606F',
'931E30D5-45D1-11E7-A9D9-D1AFCCD8D05D',
'BC2A13F7-A3AB-11E9-A51A-61AC1B87CDDD',
'A8B5F156-DF29-11E9-AF77-B9B309A920DB',
'0AC007AF-C3B3-11E9-A51A-61AC1B87CDDD',
'128008FC-F308-11EA-BD09-5F5CE34E524C',
'0FF84CAA-F308-11EA-BD09-5F5CE34E524C',
'48A7EA43-DFFB-11E9-AF77-B9B309A920DB',
'113C3E5B-F308-11EA-BD09-5F5CE34E524C',
'CC9AE987-65F1-11EB-A381-BD24EE0CC13B',
'D904DC3B-65F1-11EB-A381-BD24EE0CC13B',
'CFB1C678-65F1-11EB-A381-BD24EE0CC13B',
'D5ED14EA-65F1-11EB-A381-BD24EE0CC13B',
'C671EA95-65F1-11EB-A381-BD24EE0CC13B',
'7BC40248-6D5D-11E9-B4BF-A911074387AC',
'045BEF87-43CA-11EA-819D-37B877ECC397',
'1EA317EC-9647-11E9-A51A-61AC1B87CDDD',
'C4F7382D-DF29-11E9-AF77-B9B309A920DB',
'A18EAF56-72C4-11E9-A51A-61AC1B87CDDD',
'42928F61-432A-11EA-819D-37B877ECC397',
'1194C9DF-34B1-11E9-B4BF-A911074387AC',
'39C0CC57-749F-11EA-89C1-C7E5A3E90FFA',
'81688784-7014-11EB-B359-7F91959BF123',
'7E47E693-7014-11EB-B359-7F91959BF123',
'7B2E4A82-7014-11EB-B359-7F91959BF123',
'689F6C9B-906F-11EB-B359-7F91959BF123',
'8EB097A4-2EB8-11EB-9628-0FF1661CFF78',
'E41F83B4-98E3-11EA-89C1-C7E5A3E90FFA',
'1A76D0A6-4345-11EA-819D-37B877ECC397',
'5CBC68CF-6A50-11E9-B4BF-A911074387AC',
'7CC4A945-7011-11EB-B359-7F91959BF123',
'1956B8B2-463B-11EA-91F5-9D29A492214E',
'BF935431-4612-11E9-B4BF-A911074387AC',
'F181561D-46B9-11E9-B4BF-A911074387AC',
'95ADC8AF-4345-11EA-819D-37B877ECC397',
'F63FF07B-43D2-11EA-819D-37B877ECC397',
'AA1FBE6C-17C3-11EA-819D-37B877ECC397',
'6B3AA07C-4345-11EA-819D-37B877ECC397',
'451FF362-A09E-11EA-89C1-C7E5A3E90FFA',
'D89E5405-53A7-11EA-B1D9-BF69B691B61A',
'3E25080A-4345-11EA-819D-37B877ECC397',
'3BA9F5E8-4345-11EA-819D-37B877ECC397',
'D6005093-53A7-11EA-B1D9-BF69B691B61A',
'28957803-A3AB-11E9-A51A-61AC1B87CDDD',
'29CEE264-A3AB-11E9-A51A-61AC1B87CDDD',
'6379A356-926B-11E5-95A6-A1CA59696696',
'92D95783-224F-11EB-B81F-F3C72B473E8E',
'4CFCB1BD-F3E5-11E9-819D-37B877ECC397',
'3CE69499-4345-11EA-819D-37B877ECC397',
'2735D003-9783-11EB-B359-7F91959BF123',
'3853D5B2-7783-11E9-A51A-61AC1B87CDDD',
'43D03265-5EC8-11EB-A381-BD24EE0CC13B',
'7FE28B16-7011-11EB-B359-7F91959BF123',
'ED275260-46EA-11EA-91F5-9D29A492214E',
'13D1D9EE-46EB-11EA-91F5-9D29A492214E',
'3B834B18-72C3-11E9-A51A-61AC1B87CDDD',
'930BE2DA-46EB-11EA-91F5-9D29A492214E',
'18C03602-46EB-11EA-91F5-9D29A492214E',
'C17E9A6F-46EB-11EA-91F5-9D29A492214E',
'86C8D911-46EB-11EA-91F5-9D29A492214E',
'B8CB4718-46EB-11EA-91F5-9D29A492214E',
'726EDF12-BA9A-11EA-AB15-C57A43B26EA7',
'55AF678B-BA9A-11EA-AB15-C57A43B26EA7',
'3B834B18-72C3-11E9-A51A-61AC1B87CDDD',
'8B37CBF4-46EB-11EA-91F5-9D29A492214E',
'A5933BC9-46EB-11EA-91F5-9D29A492214E',
'030A8081-46EB-11EA-91F5-9D29A492214E',
'1C73A115-46EB-11EA-91F5-9D29A492214E',
'AE6B5530-46EB-11EA-91F5-9D29A492214E',
'FA489E0C-F70D-11EA-BD09-5F5CE34E524C',
'A1DCC376-46EB-11EA-91F5-9D29A492214E',
'D82116C0-46EA-11EA-91F5-9D29A492214E',
'96C5415D-46EB-11EA-91F5-9D29A492214E',
'C493413C-FC96-11EA-BD09-5F5CE34E524C',
'C493413C-FC96-11EA-BD09-5F5CE34E524C',
'F36042E6-FC95-11EA-BD09-5F5CE34E524C',
'6A0E6ECB-079E-11EB-BD09-5F5CE34E524C',
'11AA4305-079E-11EB-BD09-5F5CE34E524C',
'3009FC0D-079E-11EB-BD09-5F5CE34E524C',
'D32EC30C-46EA-11EA-91F5-9D29A492214E',
'D990FA71-46EA-11EA-91F5-9D29A492214E',
'9E289513-46EB-11EA-91F5-9D29A492214E',
'777CADF5-46EB-11EA-91F5-9D29A492214E',
'B6E13336-FC95-11EA-BD09-5F5CE34E524C',
'7EFEE4B3-E118-11EA-BD09-5F5CE34E524C',
'D4B667C8-4EC1-11EA-91F5-9D29A492214E',
'D37B4FB7-4EC1-11EA-91F5-9D29A492214E',
'D2390BB6-4EC1-11EA-91F5-9D29A492214E',
'D0FF7A45-4EC1-11EA-91F5-9D29A492214E',
'A20C577C-66F1-11E9-B4BF-A911074387AC',
'A4E7D6E9-224F-11EB-B81F-F3C72B473E8E',
'F70B48D4-E8BF-11E9-AF77-B9B309A920DB',
'A1E0D878-224F-11EB-B81F-F3C72B473E8E',
'BE5CF710-4612-11E9-B4BF-A911074387AC',
'BD1D993F-4612-11E9-B4BF-A911074387AC',
'5D70E8F1-079E-11EB-BD09-5F5CE34E524C',
'FA64354F-43C9-11EA-819D-37B877ECC397',
'0598B548-43CA-11EA-819D-37B877ECC397',
'907CD409-3BA2-11E7-9A28-ED1E80C01E48',
'2F88579B-75DC-11E9-A51A-61AC1B87CDDD',
'28A5996A-7E0C-11EA-89C1-C7E5A3E90FFA',
'61726B8F-6A4F-11E9-B4BF-A911074387AC',
'D8366454-6D5D-11E9-B4BF-A911074387AC',
'63249D6A-43CA-11EA-819D-37B877ECC397',
'5D7B01E0-46B8-11E9-B4BF-A911074387AC',
'60E6043E-67FB-11E9-B4BF-A911074387AC',
'15BC46AB-F70C-11EA-BD09-5F5CE34E524C',
'54F265EF-2A0F-11EB-9954-191C9BF59F0F',
'77F15279-43CA-11EA-819D-37B877ECC397',
'A70DDE9E-43CA-11EA-819D-37B877ECC397',
'9A42E024-43CA-11EA-819D-37B877ECC397',
'C4B27A16-24F1-11E9-A69C-597304835A04',
'AA600AF0-24F1-11E9-A69C-597304835A04',
'8789349B-DF29-11E9-AF77-B9B309A920DB',
'88D108A3-51F1-11EA-B1D9-BF69B691B61A',
'74FF74AF-6A4F-11E9-B4BF-A911074387AC',
'AFB15275-43CA-11EA-819D-37B877ECC397',
'A1C428C1-2003-11EB-B81F-F3C72B473E8E',
'7319E5FD-67FB-11E9-B4BF-A911074387AC',
'57A359F8-F70D-11EA-BD09-5F5CE34E524C',
'D76F0CEA-2A0E-11EB-9954-191C9BF59F0F',
'7E11C5EE-43CA-11EA-819D-37B877ECC397',
'BC5F963F-24F1-11E9-A69C-597304835A04',
'BD8FFFF0-24F1-11E9-A69C-597304835A04',
'A31B3BBA-24F1-11E9-A69C-597304835A04',
'32D2FAA5-400A-11EB-8CE9-C9B823C84DEA',
'9EEDAB8E-DF29-11E9-AF77-B9B309A920DB',
'85FCDA01-51F1-11EA-B1D9-BF69B691B61A',
'6299FC1F-6D5F-11E9-BD6D-EF3D58CBAF2C',
'64BEE6B6-46B8-11E9-B4BF-A911074387AC',
'6B7A742F-2003-11EB-B81F-F3C72B473E8E',
'10AE54A7-F70C-11EA-BD09-5F5CE34E524C',
'60D9E233-2A0F-11EB-9954-191C9BF59F0F',
'746D75A4-51F1-11EA-B1D9-BF69B691B61A',
'8D09686A-43CA-11EA-819D-37B877ECC397',
'ADFDF233-24F1-11E9-A69C-597304835A04',
'CD0277BD-24F1-11E9-A69C-597304835A04',
'E1B003DB-DF2A-11E9-AF77-B9B309A920DB',
'7CD85B8D-43CA-11EA-819D-37B877ECC397',
'BC4B4159-6D5F-11E9-BD6D-EF3D58CBAF2C',
'6FAA4FBF-46B8-11E9-B4BF-A911074387AC',
'4D4302B5-2003-11EB-B81F-F3C72B473E8E',
'274CE389-F70C-11EA-BD09-5F5CE34E524C',
'C56EBE54-2A0E-11EB-9954-191C9BF59F0F',
'71B9A042-51F1-11EA-B1D9-BF69B691B61A',
'847BEC93-43CA-11EA-819D-37B877ECC397',
'B3FF44E8-24F1-11E9-A69C-597304835A04',
'D8366454-6D5D-11E9-B4BF-A911074387AC',
'7D82FB73-DF29-11E9-AF77-B9B309A920DB',
'A8385AE5-57A4-11EA-B1D9-BF69B691B61A',
'BB56F5DA-57A5-11EA-B1D9-BF69B691B61A',
'CC09197B-60EB-11E9-8A0F-6B0B99858FC5')
          group by format_dt , man_text ,action_body.target1 ,action_body.config
      )
      order by format_dt , man_text, target
    """
    return param


def searchEsSql(param):
    cols = None
    isFirst = True
    colList = []
    dataList = []
    es = Elasticsearch(["121.125.71.147",
                        "121.125.71.148",
                        "121.125.71.149"],
                       port=9200,
                       http_auth=("elastic", "wtlcnNyrDPVko01lZfIl"),
                       timeout=200)

    while (isFirst or param["cursor"] != None):
        # param["cursor"] = cursor
        res = es.sql.query(body=param)
        if res != None:
            if "cursor" in res:
                param["cursor"] = res["cursor"]
                del param["query"]
            else:
                param["cursor"] = None

            if (cols == None):
                cols = res["columns"]
                for col in cols:
                    colList.append(col["name"])

            if (res["rows"] != None):
                for row in res["rows"]:
                    # print(row)
                    dataList.append(dict(zip(colList, row)))
        else:
            param["cursor"] = None

        isFirst = False

    return dataList


def searchDBData():
    con_pymysql = pymysql.connect(host=config['SCHDB_IP'], port=config['SCHDB_PORT'], user=config['SCHDB_USER'],
                                  password=config['SCHDB_PASSWD'],
                                  db=config['SCHDB_DB'], charset='utf8', read_timeout=20)

    cur_pymysql = con_pymysql.cursor(pymysql.cursors.DictCursor)

    cur_pymysql.execute("select nudge_type, nudge_name from nudge n  ")
    nudge_rows = cur_pymysql.fetchall()
    nudge_map = {}
    for nudge in nudge_rows:
        nudge_map[nudge["nudge_type"]] = nudge["nudge_name"]

    # cur_pymysql.execute("select `type`, suggest_name from suggest ")
    # suggest_rows = cur_pymysql.fetchall()
    # suggest_map = {}
    # for suggest in suggest_rows:
    #     suggest_map[suggest["type"]] = suggest["suggest_name"]

    cur_pymysql.execute("""
      select 
        menu_id,
        case 
          when menu_id = 'menu003' or menu_id = 'menu004'  then '시놉시스'
          else  exposure_name 
        end
        exposure_name 
      from exposure
    """)
    expo_rows = cur_pymysql.fetchall()
    expo_map = {}
    for expo in expo_rows:
        expo_map[expo["menu_id"]] = expo["exposure_name"]

    cur_pymysql.close()
    con_pymysql.close()

    return {"EXPO": expo_map, "NUDGE": nudge_map}


if __name__ == '__main__':
    # sys.argv.append('2021-04-30')
    # sys.argv.append('25')
    print('start ===')
    startDay = datetime.datetime.now()
    loop = 1

    if len(sys.argv) > 1:
        startDay = datetime.date.fromisoformat(sys.argv[1])

    if len(sys.argv) > 2:
        loop = int(sys.argv[2])

    writer = pd.ExcelWriter('./src/수동넛지_통계데이터(추가전).xlsx')

    dbData = searchDBData()
    expo_map = dbData["EXPO"]
    nudge_map = dbData['NUDGE']

    execl_rows = []
    for i in range(loop):
        target_day_str = f"{startDay.strftime('%Y-%m-%d')}"
        print(target_day_str)
        param = makeParam(target_day_str)
        dataList = searchEsSql(param)

        for data in dataList:
            data['config'] = nudge_map[data['config']]
            if data["target"] in expo_map:
                data["exposure_name"] = expo_map[data["target"]]
            else:
                data["exposure_name"] = data["target"]

            execl_row = []
            for dfi in dataField:
                execl_row.append(data[dfi])

            execl_rows.append(execl_row)

        startDay = startDay + datetime.timedelta(days=1)

    sheetName = "Sheet1"
    df = pd.DataFrame(execl_rows, columns=header)
    df.to_excel(writer, sheetName, index=False)

    writer.save()
    writer.close()
    print('end ===')
